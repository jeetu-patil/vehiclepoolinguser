"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1781],{1781:function(e,t,n){n.d(t,{VL:function(){return Q}});var r=n(5152),o=n(67294),i=n(96701),s=n(26630),a=n(25021),c=n(67380),l=n(37813),u=n(73213),d=n(59499),p=n(50029),f=n(87794),v=n.n(f),g=n(40821),m=n(357),y=n(51741),C=n(95944),b=n(83032),S=n(83403),T=n(98695),h=n(98108),w=n(73500),O=n(3299),I=n(77748),A=n(64918),P=n(32655),k=n(8924),j=n(69089),x=n(55978),D=function(e){var t=e.queryParams;return(0,m.nS)({queryParams:t}).formattedUrl};function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(e){var t=e.assetId,n=e.asset,r=n.id,o=n.tier,i=void 0===o?10:o,s=n.src,a=n.aspect,c=n.width,l=n.height;return{metadata:{notes:{media_id:t,alpha_num_id:r,rex_id:r,media_type:C.gP,tier:i,media:{aspect:a,width:c,height:l,url:s}}}}},U=function(){var e=(0,p.Z)(v().mark((function e(t){var n,r,o,i,s,c,l,u,d,p,f,g,y;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.isRexEditorial,o=t.collectionId,i=t.verificationCode,s=t.setAsCover,c=t.firstAsset,l=t.collectionType,(u=(0,a.A8)(c))===C.VT){e.next=4;break}return e.abrupt("return");case 4:return d={id:o,verificationCode:i,collectionType:l},p=(0,m.Yz)({queryParams:d}).formattedUrl,e.next=8,k.uS.get(p).then((function(e){return(0,j.O)(e.data)||{}}));case 8:if(null!==(f=e.sent)&&void 0!==f&&null!==(n=f.coverItem)&&void 0!==n&&n.id){e.next=14;break}return g=(0,a.OP)({asset:c,isRexEditorial:r}),y=(0,w.Q)({collectionId:o,mappedAssetType:u,assetId:g}),e.next=14,s({collection:{id:o},mediaItem:{id:y}});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=n(69648),Z=n(83023),J=n(4730),N=n(85893),B=["isOpen"];function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var q=(0,r.default)((function(){return Promise.all([n.e(98940),n.e(55296),n.e(52387),n.e(38799),n.e(39803),n.e(11514),n.e(48645),n.e(80158),n.e(49242),n.e(39436)]).then(n.bind(n,72959)).then((function(e){return e.CollectionModal}))}),{ssr:!1,loadableGenerated:{webpack:function(){return[72959]}}}),G=function(e){var t=e.isOpen,n=(0,J.Z)(e,B);return(0,u.B)(t)&&(0,N.jsx)(q,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({isOpen:t},n))},L=(0,r.default)((function(){return n.e(54296).then(n.bind(n,54296)).then((function(e){return e.LazyAddToCollectionModal}))}),{ssr:!1,loadableGenerated:{webpack:function(){return[54296]}}}),H=(0,r.default)((function(){return n.e(5980).then(n.bind(n,5980)).then((function(e){return e.Snackbar}))}),{ssr:!1,loadableGenerated:{webpack:function(){return[5980]}}}),z=function(e){var t=e.assets,n=e.assetType,r=e.collectionId,s=e.collectionTitle,a=e.gridItems,c=e.isDialogActive,l=e.isSnackBarOpen,d=e.onAddToCollections,p=e.onAlertSnackbarClose,f=e.onAddToCollectionsComplete,v=e.redirectToCDPAction,g=e.setIsDialogActive,m=e.showCopyToModalTitle,y=e.status,C=e.verificationCode,b=e.pageSection,S=(0,Z.p)(i.vb),T=(0,Z.p)(i.pG),h=(0,u.B)(t),w=(0,o.useCallback)((function(){return g(!1)}),[g]);return h?S||T?(0,N.jsx)(L,{onClose:w,isOpen:c,items:t,onAddToCollectionsComplete:f,pageSection:b}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(G,{assets:t,assetType:n,collectionId:r,gridItems:a,isOpen:c,onAddToCollections:d,setIsDialogActive:g,showCopyToModalTitle:m,pageSection:b}),(0,N.jsx)(H,{assetType:n,collectionId:r,collectionTitle:s,isOpen:l,onAlertSnackbarClose:p,redirectToCDPAction:v,status:y,verificationCode:C})]}):null};z.defaultProps={assetType:"",assets:null,gridItems:null,onAddToCollectionsComplete:void 0,redirectToCDPAction:{}};var Q=function(e){var t=e.initialAssetType,n=(0,o.useState)(!1),r=n[0],i=n[1],u=(0,o.useState)(!1),f=u[0],j=u[1],_=(0,o.useState)(!1),Z=_[0],J=_[1],N=(0,o.useState)(""),B=N[0],V=N[1],q=(0,o.useState)(null),G=q[0],L=q[1],H=(0,o.useState)(t),Q=H[0],Y=H[1],F=(0,o.useState)(null),W=F[0],X=F[1],K=(0,o.useState)(null),$=K[0],ee=K[1],te=(0,o.useState)(null),ne=te[0],re=te[1],oe=(0,R.B)(),ie=(0,c.cM)(),se=(0,l.L)(),ae=(0,o.useState)({shouldHandleRedirect:!1,redirectToCollectionDetailsPage:se}),ce=ae[0],le=ae[1],ue=function(){var e=(0,o.useState)({status:"",error:void 0}),t=e[0],n=e[1],r=(0,o.useState)(""),i=r[0],s=r[1],c=(0,o.useState)(""),l=c[0],u=c[1],f=(0,I.J)(),j=(0,x.w)().setAsCover,_=(0,A.D)().isBrandSstk,R=(0,P.yh)().analytics,Z=(0,T.UM)(R),J=(0,o.useCallback)(function(){var e=(0,p.Z)(v().mark((function e(t){var r,o,i,c,l,p,T,I,A,P,x,R,J,N,B,V,q,G,L,H,z,Q,Y,F;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.assets,o=t.assetType,i=t.gridItems,c=t.groupedOptions,l=t.id,p=t.title,T=t.verificationCode,I=t.pageSection,A=t.listId,P=(0,h.wZ)({assetType:o,isBrandSstk:_}),e.prev=2,n({status:y.MR,error:void 0}),x=(0,a.Xo)(o),R=l,J=T,c&&c.length&&(N=c.find((function(e){return e.title===p})))&&(R=N.id,J=N.verificationCode),R){e.next=19;break}return B=(0,m.A6)().formattedUrl,V={data:{attributes:{title:p,collectionType:P,isPublic:!1},type:b.Ul}},e.next=13,k.uS.post(B,V);case 13:q=e.sent,G=q.data,L=G.id,H=G.attributes.verificationCode,R=L,J=H;case 19:return z={data:r.map((function(e){var t=(0,a.OP)({asset:e,isRexEditorial:x}),n=(0,a.A8)(e);return E({type:b.A8,id:(0,w.Q)({collectionId:R,mappedAssetType:n,assetId:t})},n===C.VT&&M({assetId:t,asset:e}))}))},Q=(0,m.mp)({urlParams:{id:R},queryParams:{isRexEditorial:x}}).formattedUrl,Y=(0,O.y)(Z),e.next=24,k.uS.post(Q,z,Y?{headers:(0,d.Z)({},S.as,Y)}:void 0);case 24:return F=r[0],e.next=27,U({isRexEditorial:x,collectionId:R,verificationCode:J,setAsCover:j,firstAsset:F,collectionType:P});case 27:f({collectionId:R,collectionName:p,gridItems:i,assets:r,pageSection:I,listId:A}),s(R),u(J),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(2),n({status:y.cM,error:e.t0});case 35:return e.prev=35,e.next=38,(0,g.JG)(D({queryParams:{"filter[type]":P}}));case 38:return e.finish(35);case 39:case"end":return e.stop()}}),e,null,[[2,32,35,39]])})));return function(t){return e.apply(this,arguments)}}(),[f,j,Z,_]);return{add:J,collectionId:i,setStatus:n,status:t,verificationCode:l}}(),de=ue.add,pe=ue.status,fe=ue.collectionId,ve=ue.verificationCode;(0,o.useEffect)((function(){return function(){return L(null)}}),[]),(0,o.useEffect)((function(){return function(){return Y("")}}),[]);var ge=(0,o.useCallback)((function(e){var t=e.formattedAssets,n=e.gridItems,r=e.isCopyToCollection,o=e.mappedAssetType,s=e.redirectToCollectionDetailsPage,a=e.pageSection,c=e.listId;Y(o),L(t),ee(a),re(c),r&&J(!0),n&&X(n),s&&le({shouldHandleRedirect:!0,redirectToCollectionDetailsPage:s}),i(!0)}),[]);return(0,o.useEffect)((function(){(0,s.DZ)({showAddToCollectionModal:ge,isLoggedInUser:oe})}),[oe,ge]),{addToCollectionViewsProps:(0,o.useMemo)((function(){return{assets:G,pageSection:$,assetType:Q,collectionId:fe,collectionTitle:B,gridItems:W,isDialogActive:r,isSnackBarOpen:f,onAddToCollections:function(e){var t=e.id,n=e.title,r=e.verificationCode,o=e.groupedOptions,s=e.pageSection;return V(n),i(!1),j(!0),de({assetType:Q,assets:G,gridItems:W,groupedOptions:o,id:t,title:n,verificationCode:r,pageSection:s||$,listId:ne})},onAlertSnackbarClose:function(){return j(!1)},redirectToCDPAction:ce,setIsDialogActive:i,showCopyToModalTitle:Z,status:pe,verificationCode:ve}}),[G,W,de,ne,$,Q,fe,B,r,f,ce,Z,pe,ve]),addToCollectionViewsHandler:(0,o.useCallback)((function(e){var t=e.assets,n=e.gridItems,r=e.isCopyToCollection,o=void 0!==r&&r,i=e.redirectToCollectionDetailsPage,c=e.pageSection,l=e.listId;if(oe){var u=function(e){return[].concat(e)}(t);ge({formattedAssets:u,gridItems:n,isCopyToCollection:o,mappedAssetType:(0,a.A8)(u[0]),redirectToCollectionDetailsPage:i,pageSection:c,listId:l})}else(0,s.JO)({assets:t,gridItems:n,signUpPath:ie})}),[oe,ge,ie]),AddToCollectionViews:z}}},26630:function(e,t,n){n.d(t,{DZ:function(){return a},JO:function(){return s}});var r=n(25021),o="add_to_collection_asset",i="add_to_collection_grid_items",s=function(e){var t=e.assets,n=e.gridItems,r=e.signUpPath;window&&(t&&window.sessionStorage.setItem(o,JSON.stringify(t)),n&&window.sessionStorage.setItem(i,JSON.stringify(n)),window.location=r)},a=function(e){var t=e.showAddToCollectionModal,n=e.isLoggedInUser;if(void 0!==n){if(n){var s=window.sessionStorage.getItem(o),a=window.sessionStorage.getItem(i),c=function(e){return e&&"undefined"!==e};if(c(s)&&c(a)){var l=JSON.parse(s),u=JSON.parse(a),d=[].concat(l);t({formattedAssets:d,gridItems:u,mappedAssetType:(0,r.A8)(d[0]),isCopyToCollection:!1,redirectToCollectionDetailsPage:!1})}}window.sessionStorage.removeItem(o),window.sessionStorage.removeItem(i)}}},3299:function(e,t,n){n.d(t,{y:function(){return r}});var r=function(e){return[e.subPage,e.pageType].join("-")}},77748:function(e,t,n){n.d(t,{J:function(){return a}});var r=n(67294),o=n(98695),i=n(32655),s=n(94428),a=function(){var e=(0,i.yh)().analytics,t=(0,s.Y)().getSearchContext;return(0,r.useCallback)((function(n){var r=n.collectionId,i=n.collectionName,s=n.gridItems,a=n.assets,c=n.pageSection,l=n.listId;e.productAddedToWishlist({products:a.map((function(e){return(0,o.bR)({asset:e,getSearchContext:t,gridItems:s,pageSection:c})})),wishlist_id:r,wishlist_name:i,list_id:null!==l&&void 0!==l?l:""})}),[e,t])}},55978:function(e,t,n){n.d(t,{w:function(){return d}});var r=n(50029),o=n(87794),i=n.n(o),s=n(67294),a=n(357),c=n(51741),l=n(83032),u=n(8924),d=function(){var e=(0,s.useState)({status:"",error:void 0}),t=e[0],n=e[1],o=(0,s.useCallback)(function(){var e=(0,r.Z)(i().mark((function e(t){var r,o,s,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.collection,o=t.mediaItem,s=(0,a.df)({urlParams:{id:r.id}}).formattedUrl,d={data:{id:r.id,relationships:{"cover-item":{data:{id:"".concat(o.id),type:l.A8}}},type:l.Ul}},e.prev=3,n({status:c.MR,error:void 0}),e.next=7,u.uS.patch(s,d);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),n({status:c.cM,error:e.t0});case 12:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),[]);return{status:t,setStatus:n,setAsCover:o}}}}]);